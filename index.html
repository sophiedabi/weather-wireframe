<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="src/styles.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://kit.fontawesome.com/94eb027930.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>weather app</title>
  </head>
  <body>
    <div class="container">
      <div class="weather-app">
        <h1>weather app</h1>
        <div class="row">
          <div class="container container2">
            <div class="col-9">
              <form id="searchForm">
                <input type="text" id="search" placeholder="enter a city" />
                <input type="button" value="search" />
                <br />
              </form>
              <small>e.g.</small>
              <div class="row">
                <div class="col-4">
                  <div class="col-4">
                    <button class="currentB">current</button>
                  </div>
                  <div class="col-4">
                    <button class="city">Paris</button>
                  </div>
                  <div class="col-4">
                    <button class="city">London</button>
                  </div>

                  <hr />
                </div>
                <div class="col current-temperature">
                  <div id="tempNow">?°C</div>
                  <small class="currentDT" style="font-size: 10px"> </small>
                </div>
              </div>
            </div>
            <p class="forecast-label">5 day weather forecast</p>
            <hr />
            <div class="row">
              <div class="col-6">
                <div class="col-2.4">Tomorrow</div>
                <br />

                <div class="col-2.4">the day after</div>
                <br />

                <div class="col-2.4">the day after</div>
                <br />

                <div class="col-2.4">the day after</div>
                <br />

                <div class="col-2.4">the day after</div>
              </div>
              <div class="col-6">
                <div class="col-2.4">🌤 13°C</div>
                <br />
                <div class="col-2.4">❄ 6°C</div>
                <br />
                <div class="col-2.4">🌤 12°C</div>
                <br />
                <div class="col-2.4">☀ 17°C</div>
                <br />
                <div class="col-2.4">☀ 19°C</div>
              </div>
            </div>
          </div>
          <p style="font-size: 9px">
            <a href="https://github.com/sophiedabi/weather-wireframe"
              >open source code </a
            >Coded by Sophie Dabirmanesh
          </p>
        </div>
      </div>
    </div>
    <script>
      function changeCity(event) {
        event.preventDefault();
        let h1 = document.querySelector("h1");
        let cityInput = document.querySelector("#search");
        h1.innerHTML = `weather in ${cityInput.value}`;
      }

      // let searchbar = document.querySelector("#searchForm");
      // searchbar.addEventListener("submit", changeCity);

      function formatDate(date) {
        let days = [
          "Sunday",
          "Monday",
          "Tuesday",
          "Wednesday",
          "Thursday",
          "Friday",
          "Saturday",
        ];

        let currentDay = days[date.getDay()];
        let currentHour = date.getHours();
        if (currentHour < 10) {
          currentHour = `0${currentHour}`;
        }
        let minutes = date.getMinutes();
        if (minutes < 10) {
          minutes = `0${minutes}`;
        }
        return `On ${currentDay}, ${currentHour}:${minutes}`;
      }

      let now = new Date();
      let currently = document.querySelector(".currentDT");
      currently.innerHTML = formatDate(now);

      function getPosition(position) {
        let latitude = position.coords.latitude;
        let longitude = position.coords.longitude;

        let apiKey = "53551bbf2ab7d7e68f94a20c22d68b6b";
        let apiUrlCoords = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric`;

        axios.get(apiUrlCoords).then(showWeather);
      }

      function showWeather(response) {
        let h1 = document.querySelector("h1");
        h1.innerHTML = `weather in ${response.data.name}`;
        let temperature = Math.round(response.data.main.temp);
        let tempNow = document.querySelector("#tempNow");
        tempNow.innerHTML = `${temperature}°C`;
      }
      let currentButton = document.querySelector(".currentB");
      currentButton.addEventListener("click", searchGeolocation);

      function searchGeolocation() {
        console.log(navigator.geolocation.getCurrentPosition);
        navigator.geolocation.getCurrentPosition(getPosition);
      }

      function searchCity(city) {
        let apiKey = "53551bbf2ab7d7e68f94a20c22d68b6b";
        let units = "metric";
        let apiUrlWeather = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=${units}`;
        axios.get(apiUrlWeather).then(showWeather);
      }

      function submitting(event) {
        event.preventDefault();
        let city = document.querySelector("#search").value;
        searchCity(city);
      }

      let searchbar = document.querySelector("#searchForm");
      searchbar.addEventListener("submit", submitting);
    </script>
  </body>
</html>
